import { Option, OptionFactory } from ".";
import { OptionPromise } from "./OptionPromiseTypes";
import { resultPromiseFromResultAsync } from "../Result/ResultPromise";

export const optionPromiseFromOptionAsync = <TValue>(promise: Promise<Option<TValue>>) : OptionPromise<TValue> => ({
	[Symbol.toStringTag]: promise.toString(),
	then: (onfulfilled, onrejected) => promise.then(onfulfilled, onrejected),
	catch: (onrejected) => promise.catch(onrejected),
	finally: (onfinally) => promise.finally(onfinally),

	match: (some, none) => promise.then(option => option.match(some, none)),
	matchAsync: (some, none) => promise.then(option => option.matchAsync(some, none)),
	toStringAsync: () => promise.then(option => option.toString()),
	hasValue: () => promise.then(option => option.hasValue()),
	valueOrDefault: (defaultValue) => promise.then(option => option.valueOrDefault(defaultValue)),
	valueOrDefaultAsync: (defaultValue) => promise.then(option => option.valueOrDefaultAsync(defaultValue)),
	defaultIfNone: (defaultValue) => optionPromiseFromOptionAsync(promise.then(option => option.defaultIfNone(defaultValue))),
	defaultIfNoneAsync: (defaultValue) => optionPromiseFromOptionAsync(promise.then(option => option.defaultIfNoneAsync(defaultValue))),
	toNullable: () => promise.then(option => option.toNullable()),
	toResult:(failureFactory) => resultPromiseFromResultAsync(promise.then(option => option.toResult(failureFactory))),
	toResultAsync: (failureFactory) => resultPromiseFromResultAsync(promise.then(option => option.toResultAsync(failureFactory))),
	map: (map) => optionPromiseFromOptionAsync(promise.then(option => option.map(map))),
	mapAsync: (map) => optionPromiseFromOptionAsync(promise.then(option => option.mapAsync(map))),
	bind: (bind) => optionPromiseFromOptionAsync(promise.then(option => option.bind(bind))),
	bindAsync: (bind) => optionPromiseFromOptionAsync(promise.then(option => option.bindAsync(bind))),
	bindOnNone: (bindOnNone) => optionPromiseFromOptionAsync(promise.then(option => option.bindOnNone(bindOnNone))),
	bindOnNoneAsync: (bindOnNone) => optionPromiseFromOptionAsync(promise.then(option => option.bindOnNoneAsync(bindOnNone))),
	where: (predicate) => optionPromiseFromOptionAsync(promise.then(option => option.where(predicate))),
	whereAsync: (predicate) => optionPromiseFromOptionAsync(promise.then(option => option.whereAsync(predicate))),
	do: (ifSome, ifNone) => optionPromiseFromOptionAsync(promise.then(option => option.do(ifSome, ifNone))),
	doAsync: (ifSome, ifNone) => optionPromiseFromOptionAsync(promise.then(option => option.doAsync(ifSome, ifNone))),
	doAlways: (doAlways) => optionPromiseFromOptionAsync(promise.then(option => option.doAlways(doAlways))),
	doAlwaysAsync: (doAlways) => optionPromiseFromOptionAsync(promise.then(option => option.doAlwaysAsync(doAlways))),
	doIfSome:  (ifSome) => optionPromiseFromOptionAsync(promise.then(option => option.doIfSome(ifSome))),
	doIfSomeAsync: (ifSome) => optionPromiseFromOptionAsync(promise.then(option => option.doIfSomeAsync(ifSome))),
	doIfNone: (ifNone) => optionPromiseFromOptionAsync(promise.then(option => option.doIfNone(ifNone))),
	doIfNoneAsync: (ifNone) => optionPromiseFromOptionAsync(promise.then(option => option.doIfNoneAsync(ifNone))),
	apply: (ifSome, ifNone) => promise.then(option => option.apply(ifSome, ifNone)),
	applyAsync: (ifSome, ifNone) => promise.then(option => option.applyAsync(ifSome, ifNone)),
	applyAlways: (applyAlways) => promise.then(option => option.applyAlways(applyAlways)),
	applyAlwaysAsync: (applyAlways) => promise.then(option => option.applyAlwaysAsync(applyAlways)),
	applyIfSome: (ifSome) => promise.then(option => option.applyIfSome(ifSome)),
	applyIfSomeAsync: (ifSome) => promise.then(option => option.applyIfSomeAsync(ifSome)),
	applyIfNone: (ifNone) => promise.then(option => option.applyIfNone(ifNone)),
	applyIfNoneAsync: (ifNone) => promise.then(option => option.applyIfNoneAsync(ifNone)),
});